<div class="form-modules-container">
  <!-- Modal de alerta -->
  <div *ngIf="showAlert" class="alert-modal-overlay">
    <div class="alert-modal-content" [ngClass]="alertType">
      <span class="alert-icon" *ngIf="alertType === 'creado'">‚úÖ</span>
      <span class="alert-icon" *ngIf="alertType === 'eliminado'">üóëÔ∏è</span>
      <span class="alert-icon" *ngIf="alertType === 'error'">‚ùå</span>
      <span class="alert-icon" *ngIf="alertType === 'info'">‚ÑπÔ∏è</span>
      <span class="alert-msg">{{ alertMsg }}</span>
    </div>
  </div>

  <!-- Modal de confirmaci√≥n de eliminaci√≥n -->
  <div *ngIf="showConfirm" class="alert-modal-overlay">
    <div class="alert-modal-content eliminado">
      <span class="alert-icon">üóëÔ∏è</span>
      <span class="alert-msg">¬øEst√°s seguro de que deseas eliminar este form-module?</span>
      <div class="modal-actions">
        <button class="blue-btn" (click)="cancelarEliminar()">Cancelar</button>
        <button class="red-btn" (click)="confirmarEliminar()">Eliminar</button>
      </div>
    </div>
  </div>

  <!-- Header -->
  <div class="form-modules-header">
    <span class="icon"><i class="material-icons">link</i></span>
    <span class="title">Form-Modules</span>
    <button class="add-btn" (click)="abrirModal()">+ Agregar Form-Module</button>
  </div>

  <!-- Loading -->
  <div *ngIf="isLoading" class="loading-container">
    <p>Cargando form-modules...</p>
  </div>

  <!-- Lista de Form-Modules -->
  <div class="form-modules-list" *ngIf="!isLoading">
  <div class="form-module-card" *ngFor="let formModule of paginatedFormModules; let i = index">
    <div class="card-header">
      <h3>{{ formModule.formName }} - {{ formModule.moduleName }}</h3>
      <div class="card-actions">
        <button class="blue-btn" (click)="confirmarActualizacion(i)">Editar</button>
        <button class="red-btn" (click)="pedirConfirmacionEliminar(i)">Eliminar</button>
      </div>
    </div>
    <div class="card-content">
      <div class="info-row">
        <span class="label">Formulario:</span>
        <span class="value">{{ formModule.formName }}</span>
      </div>
      <div class="info-row">
        <span class="label">M√≥dulo:</span>
        <span class="value">{{ formModule.moduleName }}</span>
      </div>
    </div>
  </div>
</div>


  <!-- Paginaci√≥n -->
  <app-pagination *ngIf="!isLoading" [currentPage]="paginationConfig.currentPage"
    [totalPages]="paginationConfig.totalPages" [totalItems]="paginationConfig.totalItems"
    [itemsPerPage]="paginationConfig.itemsPerPage" (pageChange)="onPageChange($event)">
  </app-pagination>
</div>

<!-- Modal para crear/editar form-module -->
<div *ngIf="showModal" class="modal-overlay">
  <div class="modal-content">
    <button class="modal-close" (click)="cerrarModal()" title="Cerrar">&times;</button>
    <h2>{{ isEditing ? 'Editar Form-Module' : 'Agregar Form-Module' }}</h2>

    <form (ngSubmit)="guardarFormModule()" autocomplete="off">
      <!-- Selector de formulario -->
      <label>
        Formulario:
        <select [(ngModel)]="nuevoFormModule.formid" name="formid" required>
          <option [ngValue]="0" disabled selected>Seleccione un formulario</option>
          <option *ngFor="let f of forms" [ngValue]="f.id">
            {{ f.name }}
          </option>
        </select>
      </label>

      <!-- Selector de m√≥dulo -->
      <label>
        M√≥dulo:
        <select [(ngModel)]="nuevoFormModule.moduleid" name="moduleid" required>
          <option [ngValue]="0" disabled selected>Seleccione un m√≥dulo</option>
          <option *ngFor="let m of modules" [ngValue]="m.id">
            {{ m.name }}
          </option>
        </select>
      </label>

      <div class="modal-actions">
        <button type="button" (click)="cerrarModal()">Cancelar</button>
        <button type="submit" [disabled]="!nuevoFormModule.formid || !nuevoFormModule.moduleid">
          {{ isEditing ? 'Actualizar' : 'Crear' }}
        </button>
      </div>
    </form>
  </div>
</div>


<!-- Modal de confirmaci√≥n para actualizar -->
<div *ngIf="showUpdateConfirm" class="alert-modal-overlay">
  <div class="alert-modal-content eliminado">
    <span class="alert-icon">‚úèÔ∏è</span>
    <span class="alert-msg">¬øEst√° seguro que desea actualizar este form-module?</span>
    <div class="modal-actions">
      <button class="blue-btn" (click)="cancelarActualizacion()">Cancelar</button>
      <button class="blue-btn" (click)="abrirModalEditar()">S√≠, Editar</button>
    </div>
  </div>
</div>